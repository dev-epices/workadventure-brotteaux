{"version":3,"sources":["webpack://workadventure-map-starter-kit/./src/index.ts"],"names":["currentPopup","today","Date","time","getHours","getMinutes","BOT_NAME","ZONES","officeEpicesDev","officeEpicesSUpport","jitsiChillZone","jitsiGaia","jitsiHelios","jitsiNeptune","silent","terrace","WA","onInit","then","players","state","loadVariable","console","log","saveVariable","player","name","window","addEventListener","e","ui","registerMenuCommand","chat","sendChatMessage","Object","entries","forEach","zone","whereAt","keys","office","room","onEnterZone","onLeaveZone","openPopup","undefined","close"],"mappings":"mBAEA,IAAIA,EACJ,MAAMC,EAAQ,IAAIC,KACZC,EAAOF,EAAMG,WAAa,IAAMH,EAAMI,aACtCC,EAAW,SACXC,EAAc,CAChBC,gBAAiB,eACjBC,oBAAqB,mBACrBC,eAAgB,aAChBC,UAAW,OACXC,YAAa,SACbC,aAAc,UACdC,OAAQ,kBACRC,QAAS,eAGbC,GAAGC,SAASC,MAAK,KACb,MAAMC,EAAeH,GAAGI,MAAMC,aAAa,WAC3CC,QAAQC,IAAIJ,GACZH,GAAGI,MAAMI,aAAa,UAAW,OAAF,wBAAML,GAAO,CAAE,CAACH,GAAGS,OAAOC,MAAO,SAGpEC,OAAOC,iBAAiB,gBAAgB,SAAUC,GAC9C,MAAMV,EAAeH,GAAGI,MAAMC,aAAa,kBACpCF,EAAQH,GAAGS,OAAOC,MACzBV,GAAGI,MAAMI,aAAa,UAAWL,MAIrCH,GAAGc,GAAGC,oBAAoB,qBAAqB,KAC3C,MAAMZ,EAAeH,GAAGI,MAAMC,aAAa,WAM3CL,GAAGgB,KAAKC,gBAAgB,2BAA4B3B,GACpD4B,OAAOC,QAAQhB,GAASiB,SAAQ,EAAEV,EAAMW,MACpC,GAAIX,IAASV,GAAGS,OAAOC,KAAM,OAC7B,MAAMY,EAA4B,IAARD,EAAa,MAAM9B,EAAM8B,KAAU,GAC7DrB,GAAGgB,KAAKC,gBAAgB,GAAGP,IAAOY,IAAWhC,SAMrD4B,OAAOK,KAAKhC,GAAO6B,SAAQI,IACvBxB,GAAGyB,KAAKC,YAAYF,GAAQ,KACxB,MAAMrB,EAAeH,GAAGI,MAAMC,aAAa,WAC3CL,GAAGI,MAAMI,aAAa,UAAW,OAAF,wBAAML,GAAO,CAAE,CAACH,GAAGS,OAAOC,MAAOc,QAGpExB,GAAGyB,KAAKE,YAAYH,GAAS,KACzB,MAAMrB,EAAeH,GAAGI,MAAMC,aAAa,WAC3CL,GAAGI,MAAMI,aAAa,UAAW,OAAF,wBAAML,GAAO,CAAE,CAACH,GAAGS,OAAOC,MAAO,YAKxEV,GAAGyB,KAAKC,YAAY,SAAS,KACzB1C,EAAgBgB,GAAGc,GAAGc,UAAU,aAAa,QAAUzC,EAAK,OAGhEa,GAAGyB,KAAKE,YAAY,SAEpB,gBACyBE,IAAjB7C,IACAA,EAAa8C,QACb9C,OAAe6C,O","file":"script.js","sourcesContent":["/// <reference path=\"../node_modules/@workadventure/iframe-api-typings/iframe_api.d.ts\" />\n\nlet currentPopup: any = undefined;\nconst today = new Date();\nconst time = today.getHours() + \":\" + today.getMinutes();\nconst BOT_NAME = 'Alfred'\nconst ZONES : any = {\n    officeEpicesDev: 'Epices - Dev',\n    officeEpicesSUpport: 'Epices - Support',\n    jitsiChillZone: 'Pause café',\n    jitsiGaia: 'Gaia',\n    jitsiHelios: 'Helios',\n    jitsiNeptune: 'Neptune',\n    silent: 'Ne pas déranger',\n    terrace: 'Pause repas'\n}\n\nWA.onInit().then(() => {\n    const players: any = WA.state.loadVariable('players')\n    console.log(players)\n    WA.state.saveVariable('players', {...players, [WA.player.name]: ''})\n});\n\nwindow.addEventListener('beforeunload', function (e) {\n    const players: any = WA.state.loadVariable('players')\n    delete players[WA.player.name]\n    WA.state.saveVariable('players', players)\n});\n\n//////// MENU\nWA.ui.registerMenuCommand(\"Liste de presence\", () => {\n    const players: any = WA.state.loadVariable('players')\n    /*const text: string = players\n        ? Object.entries(players).map(([name, zone]) => `${name} : ${zone}`).join(\"\\n\")\n        //? players\n        : 'No one online'\n    WA.chat.sendChatMessage(`'//// Liste de présence :\\n${text}`, \"Bot\")*/\n    WA.chat.sendChatMessage('//// Liste de présence :', BOT_NAME)\n    Object.entries(players).forEach(([name, zone]: [string, any]) => {\n        if (name === WA.player.name) return\n        const whereAt : string = (zone != '' ? ` : ${ZONES[zone]}` : '')\n        WA.chat.sendChatMessage(`${name}${whereAt}`, BOT_NAME)\n    })\n})\n\n\n/////// ZONES\nObject.keys(ZONES).forEach(office => {\n    WA.room.onEnterZone(office, () => {\n        const players: any = WA.state.loadVariable('players')\n        WA.state.saveVariable('players', {...players, [WA.player.name]: office})\n    })\n    \n    WA.room.onLeaveZone(office,  () => {\n        const players: any = WA.state.loadVariable('players')\n        WA.state.saveVariable('players', {...players, [WA.player.name]: ''})\n    })\n})\n\n\nWA.room.onEnterZone('clock', () => {\n    currentPopup =  WA.ui.openPopup(\"clockPopup\",\"It's \" + time,[]);\n})\n\nWA.room.onLeaveZone('clock', closePopUp)\n\nfunction closePopUp(){\n    if (currentPopup !== undefined) {\n        currentPopup.close();\n        currentPopup = undefined;\n    }\n}\n"],"sourceRoot":""}